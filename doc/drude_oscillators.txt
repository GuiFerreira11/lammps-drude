<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
</script>

"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Section_commands.html#comm)

:line

Drude oscillators :h3

[Overview:]

This doc page gives detail about how to use the LAMMPS atom style {drude}
for simulating polarizable atoms using thermalized Drude oscillators.

The atom style {drude} is set by the "atom_style"_atom_style.html
command {atom_style drude} in the input file.  This atom style is
similar to the atom style {full}.  The atoms possess an electrostatic
charge, and bonded terms such as bonds, angles, dihedrals and
impropers can be defined.

Polarizable atoms acquire an induced electric dipole moment under the
action of an external electric field, for example the electric field
created by the surrounding particles.  Drude oscillators represent
these dipoles by two point charges bound by a harmonic potential.  In
LAMMPS, each polarizable atom is split into two particles of opposite
and fixed charge: the core and the Drude particle.  The Drude particle
can be thought of as the electron cloud whose center can be displaced
from the position of the the corresponding nucleus.

[Data file:]

Both the core atoms and the corresponding Drude particles should be
present in the data file, as "normal" atoms.  The sum of the masses of
a core-Drude pair should be the mass of the initial (unsplit) atom,
\(m_C + m_D = m\).  The sum of their charges should be the charge of
the initial (unsplit) atom, \(q_C + q_D = q\).  A harmonic potential
between the core and Drude partners should be present, with force
constant \(k_D\) and an equilibrium distance of zero. Core-Drude bonds
should appear as standard bonds in the {Bonds} section of the data
file. The (half-)stiffness of the "harmonic bond"_bond_harmonic.html
\(K_D = k_D/2\) and the Drude charge \(q_D\) are related to the atom
polarizability \(\alpha\) by

\begin\{equation\} K_D = \frac 1 2\, \frac \{q_D^2\} \alpha
\end\{equation\}

Ideally, the mass of the Drude particle should be small, and the
stiffness of the harmonic bond should be large, so that the Drude
particle remains close ot the core. However, this implies very fast
ocillations of the Drude particle and requires a very small time step.

The values of Drude mass, Drude charge, and force constant can be
chosen following different strategies, as in the following examples of
polarizable force fields. "Lamoureux and Roux"_#Lamoureux suggest
adopting a global half-stiffness, \(K_D\) = 500 kcal/(mol
&Aring;<sup>2</sup>) for all types of core-Drude bond, a global mass
\(m_D\) = 0.4 g/mol (or u) for all types of Drude particle, and to
calculate the Drude charges for individual atom types from the atom
polarizabilities using equation (1). This choice is followed in the
polarizable CHARMM force field. "Schroeder and Steinhauser"_#Schroeder
suggest adopting a global charge \(q_D\) = -1.0e and a global mass
\(m_D\) = 0.1 g/mol (or u) for all Drude particles, and to calculate
the force constant for each type of core-Drude bond from equation
(1). The timesteps used by these authors are between 0.5 and 2 fs,
with the degrees of freedom of the Drude oscillators kept cold at 1
K. In both these force fields hydrogen atoms are treated as
non-polarizable.

An additional section called {Drude Types} must be present in the data file.
It should contain one line per atom type formatted as :b
    {atom_type_id drude_type} :pre
where {atom_type_id} is the id of the atom type and {drude_type} is:

    0 for a non-polarizable atom type (typically hydrogen atoms)
    1 for the types of the cores of polarizable atoms
    2 for the types of the Drude particles :ul

The core-Drude particle pairs are identified by looking up the bonds
connecting Drude particles (which have Drude type 2) to their
respective cores.

[Special screening:]

The core and Drude partners of a pair should not interact together via
Coulomb interaction. So the {special_bonds} command should impose a
{coul} factor of 0. for 1-2 neighbors, which is the default.
Furthermore, the list of special neighbors is redefined, so that the
Drude particles are equivalent to their cores with respect to the 1-2,
1-3, etc. neighboring relations. In this manner, the same factor is
applied to each core and Drude particle in a pair.  This may require
increasing the memory reserved for storing the list of special
neighbors, which can be done using the {extra} keyword of the
{special_bonds} command.

The interaction between Drude dipoles, composed of the \(q_D\)
charge on a Drude particle and the opposite charge on
its core, should not be reduced by the {coul} factors of
{special_bonds}.  The "pair_style thole"_pair_thole.html can be used
for this purpose and for applying a Thole screening instead.  See the
doc page of this pair style for more information.

[Thermalization:]

The Drude oscillators can be thermalized at a low temperature, to approximate
a self consistent field.
This can be done with a Langevin thermostat using a specific "fix 
langevin_drude"_fix_langevin_drude.html as described in "(Jiang)"_#Jiang
or with a Lagrangian method (Nose-Hoover thermostat) using "fix 
drude/transform"_fix_drude_transform.html as described in "(Lamoureux)"_#Lamoureux.

:line

:link(Lamoureux)
[(Lamoureux)] Lamoureux and Roux, J Chem Phys, 119, 3025-3039 (2003).

:link(Schroeder)
[(Schroeder)]  Schr&ouml;der and Steinhauser, J Chem Phys, 133,
154511 (2010).

:link(Jiang)
[(Jiang)] Jiang, Hardy, Phillips, MacKerell, Schulten, and Roux, 
 J Phys Chem Lett, 2, 87-92 (2011).

