<HTML>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
</script>

<CENTER><A HREF = "http://lammps.sandia.gov">LAMMPS WWW Site</A> - <A HREF = "Manual.html">LAMMPS Documentation</A> - <A HREF = "Section_commands.html#comm">LAMMPS Commands</A> 
</CENTER>






<HR>

<A NAME = "howto_XX"></A><H4>6.XX Drude oscillators 
</H4>
<P>This section gives details about using the USER-DRUDE package to
include explicit polarization in classical force fields through Drude
oscillators, applying the extended Langrangian method described by
<A HREF = "#Lamoureux">Lamoureux and Roux</A>.  Polarizable atoms acquire an induced
electric dipole moment under the action of an external electric field,
for example the electric field created by the surrounding particles.
Drude oscillators represent these dipoles by two point charges, the
core and the Drude particle, bound by a harmonic potential. The values
of the charges are fixed; it is the distance between them and the
orientation of the dipole that represent the polarization effects. The
Drude particle can be thought of as the electron cloud whose center
can be displaced from the position of the corresponding nucleus
(core).
</P>
<P>Ideally, the mass of the Drude particles should be small and the
stiffness of the harmonic bonds connecting them to their cores should
be large, so that the Drude particles remain close to their
cores. However, this would imply very fast ocillations of the Drude
particles and require a very small time step. The extended Lagrangian
method allows the additional degrees of freedom corresponding to the
Drude particles to be thermalized using a separate thermostat. By
choosing a low temperature for these modes the trajectory of the Drude
particles approximates that of the self-consistent regime <A HREF = "#Lamoureux">(Lamoureux,
Roux)</A>, and allows integration with a timestep of the order
of the fs.
</P>
<P>Using Drude oscillators in LAMMPS requires compilation of the
USER-DRUDE package. Then, the data file has to contain information on
the Drude particles (masses, charges and bonds to the respective
cores) and the input script has to include specific commands to handle
the Drude dipoles, namelly for thermostating and short-range
screening.
</P>
<P>Examples of use of the USER-DRUDE package with flexible or rigid
molecules are distributed with the package, together with a
step-by-step tutorial.
</P>
<H5>Data file 
</H5>
Both the core atoms and the corresponding Drude particles appear in
the data file as "normal" atoms, with different atom types for Drude
particles if the respective cores are also of different atom
types. The core-Drude bonds appear as usual harmonic bonds.  An
additional section called <I>Drude Types</I> must be present in the data
file, with one line per atom type in the system, formatted as 
<BR>
<PRE><I>atom_type_id drude_type</I> 
</PRE>
<P>where <I>drude_type</I> is:
</P>
<UL><LI>    0 for non-polarizable atom types (e.g. hydrogen atoms)
<LI>    1 for the types of the cores of polarizable atoms
<LI>    2 for the types of the Drude particles 
</UL>
<P>For example:
</P>
<PRE>Drude Types 
</PRE>
<PRE>   1 1
   2 0
   3 2 
</PRE>
<P>Note: Internally within the code, the core-Drude particle pairs are
identified by looking up the bonds connecting Drude particles (Drude
type 2) to their respective cores.
</P>
<P>The sum of the masses of a core-Drude pair should be the mass of the
initial (unsplit) atom, \(m_C + m_D = m\).  The sum of their charges
should be the charge of the initial (unsplit) atom, \(q_C + q_D =
q\). These are specified in the <I>Masses</I> and <I>Atoms</I> sections of the
data file as for any typical atoms.
</P>
<P>A harmonic potential between core and Drude partners should be
present, with force constant \(k_D\) and an equilibrium distance of
zero. Core-Drude bonds should appear as standard bonds in the <I>Bonds</I>
section of the data file. The (half-)stiffness of the <A HREF = "bond_harmonic.html">harmonic
bond</A> \(K_D = k_D/2\) and the Drude charge \(q_D\)
are related to the atom polarizability \(\alpha\) by:
</P>
<P>\[ K_D = \frac 1 2\, \frac {q_D^2} \alpha \]
</P>
<P>The values of Drude mass, Drude charge, and force constant can be
chosen according to different strategies, as in the following examples
of polarizable force fields.
</P>
<UL><LI><A HREF = "#Lamoureux">Lamoureux and Roux</A> suggest adopting a global
half-stiffness, \(K_D\) = 500 kcal/(mol &Aring;<sup>2</sup>) for all
types of core-Drude bond, a global mass \(m_D\) = 0.4 u (or g/mol) for
all types of Drude particle, and to calculate the Drude charges for
individual atom types from the atom polarizabilities using equation
above. This choice is followed in the polarizable CHARMM force
field. 

<LI><A HREF = "#Schroeder">Schroeder and Steinhauser</A> suggest adopting a global
charge \(q_D\) = -1.0 e and a global mass \(m_D\) = 0.1 u (or g/mol)
for all Drude particles, and to calculate the force constant for each
type of core-Drude bond from the equation above. 
</UL>
<P>The timesteps used by these authors are between 0.5 and 2 fs, with the
degrees of freedom of the Drude oscillators kept cold at 1 K. In both
these force fields hydrogen atoms are treated as non-polarizable.
</P>
<H5>Input script 
</H5>
<P>The <I>drude</I> atom style to be set by the <A HREF = "atom_style.html">atom_style</A>
command in the input script:
</P>
<PRE>atom_style drude 
</PRE>
<P>It is similar to the <I>full</I> atom style, in that atoms can have
electrostatic charge and also bonded terms (such as bonds, angles,
dihedrals and impropers) but includes a Drude type (0, 1 or 2 as
explained previously).
</P>
<P>The <A HREF = "special_bonds.html">special_bonds</A> command should set a <I>coul</I>
factor of 0.0 for 1-2 neighbors, which is the default. The list of
special neighbors is redefined so that the Drude particles are
equivalent to their cores with respect to the 1-2, 1-3,
etc. neighboring relations. In this manner, the same special factor is
applied to each core and Drude particle in a pair.  This may require
increasing the memory reserved for storing the list of special
neighbors, which can be done using the <I>extra</I> keyword of the
<I>special_bonds</I> command. An error message will be printed by LAMMPS if
extra memory is needed for special neighbors.
</P>
<P>Induced Drude dipoles on neighboring, bonded atoms can interact too
strongly, leading to excessive correlation or even instabilities of
the trajectory. The interaction between Drude dipoles, composed of the
\(q_D\) charge on a Drude particle and the opposite charge on its
core, can be damped at short distance by the <A HREF = "pair_thole.html">pair_style
thole</A>. The pair style <I>thole</I> is to be used as
<I>hybrid/overlay</I> in the <A HREF = "pair_style.html">pair_style</A> command, since it
applies a correction to the Coulomb interactions:
</P>
<PRE>pair_style hybrid/overlay lj/cut/coul/long 10.0 thole 2.6 10.0 
</PRE>
<P>Since hybrid/overlay does not support mixing, the interaction
coefficients of all pairs must be explicitly given, both for the van
der Waals/Coulomb and for the Thole correction. See the doc page of
the <A HREF = "pair_thole.html">pair_style thole</A> for more information.
</P>
<P>The Drude oscillators can be thermalized at a low temperature, to
approximate relaxed Drudes (self consistent field).  This can be done
with a Langevin thermostat using a specific <A HREF = "fix_langevin_drude.html">fix
langevin_drude</A> as described in
<A HREF = "#Jiang">(Jiang)</A> or with an extended Lagrangian method (Nose-Hoover
thermostat) using <A HREF = "fix_drude_transform.html">fix drude/transform</A> as
described in <A HREF = "#Lamoureux">(Lamoureux)</A>. Detailed information and usage
examples can be obtained from the doc pages of <A HREF = "fix_langevin_drude.html">fix
langevin_drude</A> and <A HREF = "fix_drude_transform.html">fix
drude/transform</A>.
</P>
<P>If it is the case, labels for the Drude particles can be added to the
trajectory dump file through the <A HREF = "dump_modify.html">dump_modify
element</A> command:
</P>
<PRE>dump_modify TRAJ element ... D D 
</PRE>
<HR>

<A NAME = "Lamoureux"></A>

<P><B>(Lamoureux)</B> Lamoureux and Roux, J Chem Phys, 119, 3025-3039 (2003).
</P>
<A NAME = "Schroeder"></A>

<P><B>(Schroeder)</B>  Schr&ouml;der and Steinhauser, J Chem Phys, 133,
154511 (2010).
</P>
<A NAME = "Jiang"></A>

<P><B>(Jiang)</B> Jiang, Hardy, Phillips, MacKerell, Schulten, and Roux, 
 J Phys Chem Lett, 2, 87-92 (2011).
</P>
</HTML>
